<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Helpers For Working With PheWas And PheCode Data • phewasHelper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Helpers For Working With PheWas And PheCode Data">
<meta property="og:description" content="The goal of phewasHelper is to provide a set of simple lightweight helper functions for working with Phecode and Phewas data. ">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">phewasHelper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="phewashelper" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#phewashelper" class="anchor"></a>phewasHelper</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of phewasHelper is to provide a set of simple lightweight helper functions for working with Phecode and Phewas data.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>And the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"nstrayer/phewas_helper"</span>)</a></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>We will use a sample set of simulated PheWas data with phecodes to demonstrate the functions.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(phewasHelper)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(phewas_data)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; # A tibble: 6 x 2</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;    code    val</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; 1  281. -1.22 </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; 2  767  -3.63 </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; 3  378   2.47 </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; 4  496  -2.05 </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; 5  647   0.539</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; 6  771. -3.31</span></a></code></pre></div>
<div id="normalizing-phecodes" class="section level3">
<h3 class="hasAnchor">
<a href="#normalizing-phecodes" class="anchor"></a>Normalizing phecodes</h3>
<p>Phecodes show up in about a million different formats. In our demo data the phecodes have been converted to a numeric value. This would be an issue if we tried to harmonize with data that stored the phecodes in a string. The function <code>normalize_phecodes</code> is designed to fix this problem. It takes any phecode array and coerces it to a standard zero-padded string.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">phewas_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fixed_code =</span> <span class="kw"><a href="reference/normalize_phecodes.html">normalize_phecodes</a></span>(code)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; # A tibble: 6 x 3</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt;    code    val fixed_code</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;     </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; 1  281. -1.22  281.11    </span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; 2  767  -3.63  767.00    </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; 3  378   2.47  378.00    </span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; 4  496  -2.05  496.00    </span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; 5  647   0.539 647.00    </span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; 6  771. -3.31  771.20</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co"># Update our original data with normalized phecodes</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15">phewas_data &lt;-<span class="st"> </span>phewas_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">code =</span> <span class="kw"><a href="reference/normalize_phecodes.html">normalize_phecodes</a></span>(code))</a></code></pre></div>
</div>
<div id="getting-phecode-information" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-phecode-information" class="anchor"></a>Getting phecode information</h3>
<p>Another issue that is commonly encountered in PheWas results is wanting to know what exactly a code is. The functions <code><a href="reference/get_phecode_info.html">get_phecode_info()</a></code> and <code><a href="reference/join_phecode_info.html">join_phecode_info()</a></code> help with that.</p>
<p><code><a href="reference/get_phecode_info.html">get_phecode_info()</a></code> is the simpler of the two. It takes as input an array of phecodes and returns an array of the desired information, either description or category. This is useful for adding individual columns to a dataframe.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">phewas_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">descript =</span> <span class="kw"><a href="reference/get_phecode_info.html">get_phecode_info</a></span>(code, <span class="st">'description'</span>),</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">         <span class="dt">category =</span> <span class="kw"><a href="reference/get_phecode_info.html">get_phecode_info</a></span>(code, <span class="st">'category'</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;   code      val descript                                      category          </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;                                         &lt;chr&gt;             </span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; 1 281.11 -1.22  Pernicious anemia                             hematopoietic     </span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; 2 767.00 -3.63  Cervicocranial/Cervicobrachial syndrome       symptoms          </span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; 3 378.00  2.47  Strabismus and other disorders of binocular … sense organs      </span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; 4 496.00 -2.05  Chronic airway obstruction                    respiratory       </span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; 5 647.00  0.539 Infectious and parasitic complications affec… pregnancy complic…</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; 6 771.20 -3.31  Cramp of limb                                 symptoms</span></a></code></pre></div>
<p>For more a more complete labeling of phecode information the function <code><a href="reference/join_phecode_info.html">join_phecode_info()</a></code> modifies a passsed dataframe by appending a desired subset of description, category, category number, and phecode index columns.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># We can append all info available</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">phewas_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="reference/join_phecode_info.html">join_phecode_info</a></span>(<span class="dt">phecode_column =</span> code) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; # A tibble: 6 x 6</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt;   code      val description            category    category_number phecode_index</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;                  &lt;chr&gt;                 &lt;int&gt;         &lt;int&gt;</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; 1 281.11 -1.22  Pernicious anemia      hematopoie…               4           387</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; 2 767.00 -3.63  Cervicocranial/Cervic… symptoms                 17          1677</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; 3 378.00  2.47  Strabismus and other … sense orga…               7           689</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; 4 496.00 -2.05  Chronic airway obstru… respiratory               9           937</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; 5 647.00  0.539 Infectious and parasi… pregnancy …              12          1350</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; 6 771.20 -3.31  Cramp of limb          symptoms                 17          1682</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co"># Or we can just extract what we need</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17">phewas_data &lt;-<span class="st"> </span>phewas_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="st">  </span><span class="kw"><a href="reference/join_phecode_info.html">join_phecode_info</a></span>(<span class="dt">phecode_column =</span> code,</a>
<a class="sourceLine" id="cb5-19" data-line-number="19">                    <span class="dt">cols_to_join =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"description"</span>, <span class="st">"category"</span>, <span class="st">"phecode_index"</span>))</a>
<a class="sourceLine" id="cb5-20" data-line-number="20"></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(phewas_data)</a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt;   code      val description                        category        phecode_index</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;                              &lt;chr&gt;                   &lt;int&gt;</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt; 1 281.11 -1.22  Pernicious anemia                  hematopoietic             387</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">#&gt; 2 767.00 -3.63  Cervicocranial/Cervicobrachial sy… symptoms                 1677</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">#&gt; 3 378.00  2.47  Strabismus and other disorders of… sense organs              689</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="co">#&gt; 4 496.00 -2.05  Chronic airway obstruction         respiratory               937</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="co">#&gt; 5 647.00  0.539 Infectious and parasitic complica… pregnancy comp…          1350</span></a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="co">#&gt; 6 771.20 -3.31  Cramp of limb                      symptoms                 1682</span></a></code></pre></div>
</div>
<div id="coloring-phewas-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#coloring-phewas-plots" class="anchor"></a>Coloring PheWas plots</h3>
<p>Manhattan plots are commonly made of phewas results. Frequently the colors of the plots points are encoded by the categories. The default color palletes in ggplot2 and base-plot are not great and custom palletes like R color-brewer don’t give you enough colors to work with all the categories. To deal with this <code><a href="reference/category_colors.html">category_colors()</a></code> returns a mapping of phecode category to colors that can be used easily in your plots.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">phewas_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(code, phecode_index), <span class="dt">y =</span> val, <span class="dt">color =</span> category)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="reference/category_colors.html">category_colors</a></span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.ticks.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">        <span class="dt">axis.text.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">        <span class="dt">panel.grid.major.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">        <span class="dt">panel.grid.minor.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>())</a></code></pre></div>
<p><img src="reference/figures/README-plot-w-category_colors-1.png" width="100%"></p>
<p>If just the color pallete is needed for <code>ggplot</code> then the function <code><a href="reference/scale_color_phecode.html">scale_color_phecode()</a></code> makes this even easier.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">phewas_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(code, phecode_index), <span class="dt">y =</span> val, <span class="dt">color =</span> category)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="reference/scale_color_phecode.html">scale_color_phecode</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.ticks.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">        <span class="dt">axis.text.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">        <span class="dt">panel.grid.major.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">        <span class="dt">panel.grid.minor.x =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>())</a></code></pre></div>
<p><img src="reference/figures/README-plot-w-scale_color_phecode-1.png" width="100%"></p>
</div>
<div id="ggplot-theme" class="section level3">
<h3 class="hasAnchor">
<a href="#ggplot-theme" class="anchor"></a>ggplot theme</h3>
<p>One last helper is a theme object that lets you get rid of the tick marks for each phecode without the laboreous typing of <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme(axis.ticks.x = ...)</a></code> repeatedly.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">phewas_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(code, phecode_index), <span class="dt">y =</span> val, <span class="dt">color =</span> category)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="reference/category_colors.html">category_colors</a></span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="reference/theme_phewas.html">theme_phewas</a></span>()</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"></p>
<p>It can also be used on phecode-on-y-axis plots.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">phewas_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(code, phecode_index), <span class="dt">x =</span> val, <span class="dt">color =</span> category)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="reference/category_colors.html">category_colors</a></span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="reference/theme_phewas.html">theme_phewas</a></span>(<span class="dt">phecode_on_x_axis =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
</div>
<div id="rolling-up-phecodes" class="section level3">
<h3 class="hasAnchor">
<a href="#rolling-up-phecodes" class="anchor"></a>Rolling up phecodes</h3>
<p>Sometimes phecodes are reported with only the leaf values filled in. These data can be converted to a full - or “rolled up” - format with the functions <code><a href="reference/rollup_phecode_counts.html">rollup_phecode_counts()</a></code> and <code>rollup_phecode_pairs</code>. First let’s look at the counts version.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Patient data with non-rolled up codes</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">patient_data &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tribble</a></span>(</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  <span class="op">~</span>patient,    <span class="op">~</span>code, <span class="op">~</span>counts,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">         <span class="dv">1</span>, <span class="st">"250.23"</span>,      <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">         <span class="dv">1</span>, <span class="st">"250.25"</span>,      <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">         <span class="dv">1</span>, <span class="st">"696.40"</span>,      <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">         <span class="dv">1</span>, <span class="st">"555.21"</span>,      <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">         <span class="dv">2</span>, <span class="st">"401.22"</span>,      <span class="dv">6</span>,</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">         <span class="dv">2</span>, <span class="st">"204.00"</span>,      <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">         <span class="dv">2</span>, <span class="st">"751.11"</span>,      <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">         <span class="dv">2</span>, <span class="st">"008.00"</span>,      <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb10-12" data-line-number="12">         <span class="dv">2</span>, <span class="st">"008.50"</span>,      <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">         <span class="dv">2</span>, <span class="st">"008.51"</span>,      <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">)</a>
<a class="sourceLine" id="cb10-15" data-line-number="15"></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co"># Rollup the leaf codes to their parents</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17">patient_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="st">  </span><span class="kw"><a href="reference/rollup_phecode_counts.html">rollup_phecode_counts</a></span>(<span class="dt">phecode_col =</span> code) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="st">  </span>knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">code</th>
<th align="right">patient</th>
<th align="right">counts</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">250.00</td>
<td align="right">1</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="left">250.20</td>
<td align="right">1</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="left">250.23</td>
<td align="right">1</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">250.25</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">555.00</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">555.20</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<p>We can also do the same with data that just represents binary yes or no for phecode occurances with <code><a href="reference/rollup_phecode_pairs.html">rollup_phecode_pairs()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Patient data with non-rolled up codes</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">patient_data &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tribble</a></span>(</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="op">~</span>patient,     <span class="op">~</span>code, </a>
<a class="sourceLine" id="cb11-4" data-line-number="4">         <span class="dv">1</span>,  <span class="st">"250.23"</span>,    </a>
<a class="sourceLine" id="cb11-5" data-line-number="5">         <span class="dv">1</span>,  <span class="st">"250.25"</span>,    </a>
<a class="sourceLine" id="cb11-6" data-line-number="6">         <span class="dv">1</span>,  <span class="st">"696.40"</span>,    </a>
<a class="sourceLine" id="cb11-7" data-line-number="7">         <span class="dv">1</span>,  <span class="st">"555.21"</span>,    </a>
<a class="sourceLine" id="cb11-8" data-line-number="8">         <span class="dv">2</span>,  <span class="st">"401.22"</span>,    </a>
<a class="sourceLine" id="cb11-9" data-line-number="9">         <span class="dv">2</span>,  <span class="st">"204.00"</span>,    </a>
<a class="sourceLine" id="cb11-10" data-line-number="10">         <span class="dv">2</span>,  <span class="st">"751.11"</span>,    </a>
<a class="sourceLine" id="cb11-11" data-line-number="11">         <span class="dv">2</span>,  <span class="st">"008.00"</span>,    </a>
<a class="sourceLine" id="cb11-12" data-line-number="12">         <span class="dv">2</span>,  <span class="st">"008.50"</span>,    </a>
<a class="sourceLine" id="cb11-13" data-line-number="13">         <span class="dv">2</span>,  <span class="st">"008.51"</span>,    </a>
<a class="sourceLine" id="cb11-14" data-line-number="14">)</a>
<a class="sourceLine" id="cb11-15" data-line-number="15"></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co"># Rollup the leaf codes to their parents</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17">patient_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="st">  </span><span class="kw"><a href="reference/rollup_phecode_pairs.html">rollup_phecode_pairs</a></span>(<span class="dt">phecode_col =</span> code) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="st">  </span><span class="kw">arrange</span>(code) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="st">  </span>knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">patient</th>
<th align="left">code</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="left">008.00</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">008.50</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">008.51</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">204.00</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">250.00</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">250.20</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Nick Strayer <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Nick Strayer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
